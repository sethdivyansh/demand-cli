(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[172],{63:(e,s,t)=>{Promise.resolve().then(t.bind(t,835))},835:(e,s,t)=>{"use strict";t.d(s,{JobHistory:()=>D});var a=t(5155),l=t(7778),i=t(2115),n=t(6695),r=t(285),c=t(9145),d=t(3977),o=t(6126),x=t(772),m=t(9434),h=t(4357),u=t(2657),j=t(6671);let p=[{accessorKey:"id",header:e=>{let{column:s}=e;return(0,a.jsx)(x.w,{column:s,title:"JD No"})},cell:e=>{let{row:s}=e;return(0,a.jsxs)("div",{className:"font-medium",children:["#",s.getValue("id")]})}},{accessorKey:"template_id",header:e=>{let{column:s}=e;return(0,a.jsx)(x.w,{column:s,title:"Template ID"})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"font-mono text-sm",children:s.getValue("template_id")})}},{accessorKey:"channel_id",header:e=>{let{column:s}=e;return(0,a.jsx)(x.w,{column:s,title:"Channel"})},cell:e=>{let{row:s}=e;return(0,a.jsxs)(o.E,{variant:"secondary",children:["CH-",s.getValue("channel_id")]})}},{accessorKey:"txid_count",header:e=>{let{column:s}=e;return(0,a.jsx)(x.w,{column:s,title:"TX Count"})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"text-center font-medium",children:s.getValue("txid_count")})}},{accessorKey:"mining_job_token",header:e=>{let{column:s}=e;return(0,a.jsx)(x.w,{column:s,title:"Mining Job Token Hex"})},cell:e=>{let{row:s}=e,t=s.getValue("mining_job_token"),l="".concat(t.slice(0,8),"...").concat(t.slice(-8));return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("code",{className:"bg-muted rounded px-2 py-1 font-mono text-sm",children:l}),(0,a.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(t),j.oR.success("Mining Job Token Hex copied to clipboard")},children:(0,a.jsx)(h.A,{className:"h-3 w-3"})})]})},enableSorting:!1},{accessorKey:"created_at",header:e=>{let{column:s}=e;return(0,a.jsx)(x.w,{column:s,title:"Created"})},cell:e=>{let{row:s}=e;return(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:(0,m.r6)(s.getValue("created_at"))})}},{id:"actions",header:"Actions",cell:e=>{let{row:s}=e,t=s.original;return(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(r.$,{variant:"ghost",size:"sm",onClick:()=>{window.dispatchEvent(new CustomEvent("view-job-txids",{detail:{templateId:t.template_id}}))},children:[(0,a.jsx)(u.A,{className:"h-3 w-3"}),"View TXIDs"]})})}}];var g=t(4382),f=t(6424),v=t(2346),N=t(9946);let b=(0,N.A)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var w=t(1788);function y(e){let{isOpen:s,onClose:t,templateId:l}=e,{data:c,loading:d,error:x}=function(e){let[s,t]=(0,i.useState)(null),[a,l]=(0,i.useState)(!1),[n,r]=(0,i.useState)(null),c=(0,i.useCallback)(async()=>{if(e){l(!0),r(null);try{let s=await fetch("http://localhost:3001/api/job-txids/".concat(e));if(!s.ok)throw Error("HTTP error! status: ".concat(s.status));let a=await s.json();if(!a.success)throw Error("Failed to fetch job txids");t(a)}catch(e){r(e instanceof Error?e.message:"Unknown error occurred")}finally{l(!1)}}},[e]);return(0,i.useEffect)(()=>{c()},[c]),{data:s,loading:a,error:n,refetch:c}}(l),u=async()=>{(null==c?void 0:c.data.txids)&&(await (0,m.Yu)(c.data.txids),j.oR.success("".concat(c.data.txids.length," TXIDs copied to clipboard")))},p=async e=>{await navigator.clipboard.writeText(e),j.oR.success("TXID copied to clipboard")},N=async()=>{if(null==c?void 0:c.data.txids){let e=["txid",...c.data.txids].join("\n");await (0,m.Bf)(e,"job-txids-".concat(l,".csv")),j.oR.success("TXIDs exported to CSV")}};return(0,a.jsx)(g.a,{title:"Job TXIDs - Template ".concat(l),description:"Transaction IDs included in this job declaration",isOpen:s,onClose:t,size:"3xl",children:(0,a.jsxs)("div",{className:"space-y-4",children:[d&&(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)("div",{className:"text-muted-foreground",children:"Loading transaction IDs..."})}),x&&(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsxs)("div",{className:"text-destructive",children:["Error: ",x]})}),c&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.Zp,{children:[(0,a.jsx)(n.aR,{children:(0,a.jsxs)(n.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(b,{className:"h-4 w-4"}),"Transaction Summary"]})}),(0,a.jsx)(n.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"Template ID"}),(0,a.jsx)("div",{className:"font-medium",children:c.data.template_id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:"Total TXIDs"}),(0,a.jsx)("div",{className:"font-medium",children:c.data.total})]})]})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(o.E,{variant:"outline",className:"text-sm",children:[c.data.total," Transaction",1!==c.data.total?"s":""]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:u,className:"flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"h-3 w-3"}),"Copy All"]}),(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:N,className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-3 w-3"}),"Export CSV"]})]})]}),(0,a.jsx)(v.Separator,{}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:"Transaction IDs"}),(0,a.jsx)(f.F,{className:"h-96 w-full rounded-md border",children:(0,a.jsx)("div",{className:"space-y-2 p-4",children:c.data.txids.map((e,s)=>(0,a.jsxs)("div",{className:"hover:bg-muted flex items-center justify-between rounded-md p-2 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.E,{variant:"secondary",className:"text-xs",children:s+1}),(0,a.jsx)("code",{className:"bg-muted rounded px-2 py-1 font-mono text-sm",children:e})]}),(0,a.jsx)(r.$,{variant:"ghost",size:"sm",onClick:()=>p(e),className:"ml-2",children:(0,a.jsx)(h.A,{className:"h-3 w-3"})})]},e))})})]})]})]})})}var k=t(9409),C=t(3096),S=t(2278),_=t(2767);function T(e){let{currentPage:s,totalPages:t,pageSize:l,totalItems:i,pageSizeOptions:n=[10,20,30,40,50],onPageChange:c,onPageSizeChange:d,loading:o=!1}=e,x=s>1,m=s<t,h=0===i?0:(s-1)*l+1,u=Math.min(s*l,i);return(0,a.jsxs)("div",{className:"flex w-full flex-col-reverse items-center justify-between gap-4 overflow-auto p-1 sm:flex-row sm:gap-8",children:[(0,a.jsxs)("div",{className:"text-muted-foreground flex-1 text-sm whitespace-nowrap",children:["Showing ",h," to ",u," of ",i," entries"]}),(0,a.jsxs)("div",{className:"flex flex-col-reverse items-center gap-4 sm:flex-row sm:gap-6 lg:gap-8",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium whitespace-nowrap",children:"Rows per page"}),(0,a.jsxs)(k.l6,{value:"".concat(l),onValueChange:e=>d(Number(e)),disabled:o,children:[(0,a.jsx)(k.bq,{className:"h-8 w-[70px]",children:(0,a.jsx)(k.yv,{placeholder:l})}),(0,a.jsx)(k.gC,{side:"top",children:n.map(e=>(0,a.jsx)(k.eb,{value:"".concat(e),children:e},e))})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-center text-sm font-medium",children:["Page ",s," of ",t]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(r.$,{"aria-label":"Go to first page",variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>c(1),disabled:!x||o,children:(0,a.jsx)(S.A,{className:"h-4 w-4","aria-hidden":"true"})}),(0,a.jsx)(r.$,{"aria-label":"Go to previous page",variant:"outline",className:"h-8 w-8 p-0",onClick:()=>c(s-1),disabled:!x||o,children:(0,a.jsx)(C.YJP,{className:"h-4 w-4","aria-hidden":"true"})}),(0,a.jsx)(r.$,{"aria-label":"Go to next page",variant:"outline",className:"h-8 w-8 p-0",onClick:()=>c(s+1),disabled:!m||o,children:(0,a.jsx)(C.vKP,{className:"h-4 w-4","aria-hidden":"true"})}),(0,a.jsx)(r.$,{"aria-label":"Go to last page",variant:"outline",className:"hidden h-8 w-8 p-0 lg:flex",onClick:()=>c(t),disabled:!m||o,children:(0,a.jsx)(_.A,{className:"h-4 w-4","aria-hidden":"true"})})]})]})]})}let E=(0,N.A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var I=t(6268);function A(e){var s,t,l;let{page:o=1,perPage:x=10}=e,[m,h]=(0,i.useState)(null),[u,j]=(0,i.useState)(!1),[g,f]=(0,i.useState)(o),[v,N]=(0,i.useState)(x),{data:b,loading:w,error:k,refetch:C}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{page:s=1,per_page:t=10}=e,[a,l]=(0,i.useState)(null),[n,r]=(0,i.useState)(!1),[c,d]=(0,i.useState)(null),o=(0,i.useCallback)(async()=>{r(!0),d(null);try{let e=new URLSearchParams({page:s.toString(),per_page:t.toString()}),a=await fetch("http://localhost:3001/api/job-history?".concat(e));if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));let i=await a.json();if(!i.success)throw Error("Failed to fetch job history");l(i)}catch(e){d(e instanceof Error?e.message:"Unknown error occurred")}finally{r(!1)}},[s,t]);return(0,i.useEffect)(()=>{o()},[o]),{data:a,loading:n,error:c,refetch:o}}({page:g,per_page:v}),S=(null==b||null==(s=b.data)?void 0:s.jobs)||[],_=(null==b||null==(t=b.data)?void 0:t.total_pages)||0,A=(null==b||null==(l=b.data)?void 0:l.total)||0,{table:D}=(0,d.u)({data:S,columns:p,getRowId:e=>e.id.toString(),initialState:{pagination:{pageIndex:0,pageSize:S.length||v}}});(0,i.useEffect)(()=>{D.setPageSize(S.length||v),D.setPageIndex(0)},[S,v,D]),(0,i.useEffect)(()=>{let e=e=>{let{templateId:s}=e.detail;h(s),j(!0)};return window.addEventListener("view-job-txids",e),()=>{window.removeEventListener("view-job-txids",e)}},[]);let P=()=>{C()};return k?(0,a.jsx)(n.Zp,{className:"p-6",children:(0,a.jsxs)("div",{className:"space-y-4 text-center",children:[(0,a.jsxs)("div",{className:"text-destructive",children:["Error loading job history: ",k]}),(0,a.jsxs)(r.$,{onClick:P,variant:"outline",children:[(0,a.jsx)(E,{className:"mr-2 h-4 w-4"}),"Try Again"]})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Zp,{children:(0,a.jsxs)("div",{className:"px-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2 py-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.w,{table:D}),(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:P,disabled:w,children:(0,a.jsx)(E,{className:"h-4 w-4 ".concat(w?"animate-spin":"")})})]}),(0,a.jsx)("div",{className:"text-muted-foreground text-sm",children:w?"Loading...":"".concat(A," total job").concat(1!==A?"s":"")})]}),(0,a.jsx)("div",{className:"overflow-hidden rounded-md border",children:(0,a.jsxs)("table",{className:"w-full caption-bottom text-sm",children:[(0,a.jsx)("thead",{className:"[&_tr]:border-b",children:D.getHeaderGroups().map(e=>(0,a.jsx)("tr",{className:"hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",children:e.headers.map(e=>(0,a.jsx)("th",{className:"text-muted-foreground h-12 px-4 text-left align-middle font-medium [&:has([role=checkbox])]:pr-0",children:e.isPlaceholder?null:(0,I.Kv)(e.column.columnDef.header,e.getContext())},e.id))},e.id))}),(0,a.jsxs)("tbody",{className:"[&_tr:last-child]:border-0",children:[0!==S.length||w?D.getRowModel().rows.map(e=>(0,a.jsx)("tr",{className:"hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",children:e.getVisibleCells().map(e=>(0,a.jsx)("td",{className:"p-4 align-middle [&:has([role=checkbox])]:pr-0",children:(0,I.Kv)(e.column.columnDef.cell,e.getContext())},e.id))},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:D.getAllColumns().length,className:"h-24 text-center",children:"No results."})}),w&&(0,a.jsx)("tr",{className:"bg-background/70 absolute inset-0",children:(0,a.jsx)("td",{colSpan:D.getAllColumns().length,className:"h-24 text-center",children:"Loading..."})})]})]})}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)(T,{currentPage:g,totalPages:_,pageSize:v,totalItems:A,onPageChange:f,onPageSizeChange:e=>{N(e),f(1)},loading:w})})]})}),(0,a.jsx)(y,{isOpen:u,onClose:()=>j(!1),templateId:m})]})}function D(){return(0,a.jsx)(l.A,{children:(0,a.jsxs)("div",{className:"w-full space-y-4",children:[(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Job Declaration History"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"View your submitted job declarations"})]})}),(0,a.jsx)(A,{})]})})}},6424:(e,s,t)=>{"use strict";t.d(s,{F:()=>n});var a=t(5155);t(2115);var l=t(7655),i=t(9434);function n(e){let{className:s,children:t,...n}=e;return(0,a.jsxs)(l.bL,{"data-slot":"scroll-area",className:(0,i.cn)("relative",s),...n,children:[(0,a.jsx)(l.LM,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),(0,a.jsx)(r,{}),(0,a.jsx)(l.OK,{})]})}function r(e){let{className:s,orientation:t="vertical",...n}=e;return(0,a.jsx)(l.VM,{"data-slot":"scroll-area-scrollbar",orientation:t,className:(0,i.cn)("flex touch-none p-px transition-colors select-none","vertical"===t&&"h-full w-2.5 border-l border-l-transparent","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent",s),...n,children:(0,a.jsx)(l.lr,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}},7778:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});var a=t(5155);t(2115);var l=t(6424);function i(e){let{children:s,scrollable:t=!0}=e;return(0,a.jsx)(a.Fragment,{children:t?(0,a.jsx)(l.F,{className:"h-[calc(100dvh-52px)]",children:(0,a.jsx)("div",{className:"flex flex-1 p-4 md:px-6",children:s})}):(0,a.jsx)("div",{className:"flex flex-1 p-4 md:px-6",children:s})})}}},e=>{var s=s=>e(e.s=s);e.O(0,[105,277,671,690,428,904,655,541,871,441,684,358],()=>s(63)),_N_E=e.O()}]);